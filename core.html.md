# dialoghelper


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
from fastcore import tools
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L40"
target="_blank" style="float:right; font-size:smaller">source</a>

### set_var

>  set_var (var:str, val)

*Set var to val after finding it in all frames of the call stack*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L36"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_var

>  find_var (var:str)

*Search for var in all frames of the call stack*

``` python
a = 1
find_var('a')
```

    1

``` python
set_var('a', 42)
a
```

    42

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L47"
target="_blank" style="float:right; font-size:smaller">source</a>

### call_endp

>  call_endp (path, dname='', json=False, raiseex=False, **data)

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L56"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_dname

>  find_dname ()

\*Get the message id by searching the call stack for \_\_dialog_id.\*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L61"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_msg_id

>  find_msg_id ()

\*Get the message id by searching the call stack for \_\_dialog_id.\*

``` python
find_msg_id()
```

    '_9cbd170d'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L66"
target="_blank" style="float:right; font-size:smaller">source</a>

### curr_dialog

>  curr_dialog (with_messages:bool=False, dname:str='')

*Get the current dialog info.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>with_messages</td>
<td>bool</td>
<td>False</td>
<td>Include messages as well?</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L75"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_msgs

>  find_msgs (re_pattern:str='', msg_type:str=None, limit:int=None,
>                 include_output:bool=True, dname:str='')

*Find `list[dict]` of messages in current specific dialog that contain
the given information. To refer to a message found later, use its `id`
field.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>re_pattern</td>
<td>str</td>
<td></td>
<td>Optional regex to search for (re.DOTALL+re.MULTILINE is used)</td>
</tr>
<tr>
<td>msg_type</td>
<td>str</td>
<td>None</td>
<td>optional limit by message type (‘code’, ‘note’, or ‘prompt’)</td>
</tr>
<tr>
<td>limit</td>
<td>int</td>
<td>None</td>
<td>Optionally limit number of returned items</td>
</tr>
<tr>
<td>include_output</td>
<td>bool</td>
<td>True</td>
<td>Include output in returned dict?</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
# NB: must have a dialogue open including a message with this text in its content
txt = 'tools'
found = find_msgs(txt)
found[0]['content']
```

    'from fastcore import tools'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L89"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_idx

>  msg_idx (msgid=None, dname:str='')

*Get absolute index of message in dialog.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>NoneType</td>
<td>None</td>
<td>Message id to find (defaults to current message)</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
msg_idx()
```

    15

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L98"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_html

>  add_html (content:str, dname:str='')

*Send HTML to the browser to be swapped into the DOM*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>content</td>
<td>str</td>
<td></td>
<td>The HTML to send to the client (generally should include
hx-swap-oob)</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
from fasthtml.common import *
```

``` python
add_html(Div(P('Hi'), hx_swap_oob='beforeend:#dialog-container'))
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L109"
target="_blank" style="float:right; font-size:smaller">source</a>

### add_msg

>  add_msg (content:str, placement:str='add_after', msgid:str=None,
>               msg_type:str='note', output:str='', time_run:str|None='',
>               is_exported:int|None=0, skipped:int|None=0,
>               i_collapsed:int|None=0, o_collapsed:int|None=0,
>               heading_collapsed:int|None=0, pinned:int|None=0, dname:str='')

*Add/update a message to the queue to show after code execution
completes.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>content</td>
<td>str</td>
<td></td>
<td>Content of the message (i.e the message prompt, code, or note
text)</td>
</tr>
<tr>
<td>placement</td>
<td>str</td>
<td>add_after</td>
<td>Can be ‘add_after’, ‘add_before’, ‘at_start’, ‘at_end’</td>
</tr>
<tr>
<td>msgid</td>
<td>str</td>
<td>None</td>
<td>id of message that placement is relative to (if None, uses current
message)</td>
</tr>
<tr>
<td>msg_type</td>
<td>str</td>
<td>note</td>
<td>Message type, can be ‘code’, ‘note’, or ‘prompt’</td>
</tr>
<tr>
<td>output</td>
<td>str</td>
<td></td>
<td>For prompts/code, initial output</td>
</tr>
<tr>
<td>time_run</td>
<td>str | None</td>
<td></td>
<td>When was message executed</td>
</tr>
<tr>
<td>is_exported</td>
<td>int | None</td>
<td>0</td>
<td>Export message to a module?</td>
</tr>
<tr>
<td>skipped</td>
<td>int | None</td>
<td>0</td>
<td>Hide message from prompt?</td>
</tr>
<tr>
<td>i_collapsed</td>
<td>int | None</td>
<td>0</td>
<td>Collapse input?</td>
</tr>
<tr>
<td>o_collapsed</td>
<td>int | None</td>
<td>0</td>
<td>Collapse output?</td>
</tr>
<tr>
<td>heading_collapsed</td>
<td>int | None</td>
<td>0</td>
<td>Collapse heading section?</td>
</tr>
<tr>
<td>pinned</td>
<td>int | None</td>
<td>0</td>
<td>Pin to context?</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
print(__msg_id)
_id = add_msg('testing')
print(__msg_id)
```

    _9c544573
    _34f2d6f2

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L134"
target="_blank" style="float:right; font-size:smaller">source</a>

### del_msg

>  del_msg (msgid:str=None, dname:str='')

*Delete a message from the dialog.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td>None</td>
<td>id of message to delete</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
del_msg(_id)
```

``` python
_id = _add_msg_unsafe('1+1', run=True, msg_type='code')
```

``` python
del_msg(_id)
```

``` python
_id = _add_msg_unsafe('Hi', run=True, msg_type='prompt')
```

``` python
del_msg(_id)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L175"
target="_blank" style="float:right; font-size:smaller">source</a>

### update_msg

>  update_msg (msgid:str=None, msg:Optional[Dict]=None, dname:str='',
>                  content:str|None=None, msg_type:str|None=None,
>                  output:str|None=None, time_run:str|None=None,
>                  is_exported:int|None=None, skipped:int|None=None,
>                  i_collapsed:int|None=None, o_collapsed:int|None=None,
>                  heading_collapsed:int|None=None, pinned:int|None=None)

*Update an existing message. Provide either `msg` OR field key/values to
update. Use `content` param to update contents. Only include parameters
to update–missing ones will be left unchanged.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td>None</td>
<td>id of message to update (if None, uses current message)</td>
</tr>
<tr>
<td>msg</td>
<td>Optional</td>
<td>None</td>
<td>Dictionary of field keys/values to update</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
<tr>
<td>content</td>
<td>str | None</td>
<td>None</td>
<td>Content of the message (i.e the message prompt, code, or note
text)</td>
</tr>
<tr>
<td>msg_type</td>
<td>str | None</td>
<td>None</td>
<td>Message type, can be ‘code’, ‘note’, or ‘prompt’</td>
</tr>
<tr>
<td>output</td>
<td>str | None</td>
<td>None</td>
<td>For prompts/code, the output</td>
</tr>
<tr>
<td>time_run</td>
<td>str | None</td>
<td>None</td>
<td>When was message executed</td>
</tr>
<tr>
<td>is_exported</td>
<td>int | None</td>
<td>None</td>
<td>Export message to a module?</td>
</tr>
<tr>
<td>skipped</td>
<td>int | None</td>
<td>None</td>
<td>Hide message from prompt?</td>
</tr>
<tr>
<td>i_collapsed</td>
<td>int | None</td>
<td>None</td>
<td>Collapse input?</td>
</tr>
<tr>
<td>o_collapsed</td>
<td>int | None</td>
<td>None</td>
<td>Collapse output?</td>
</tr>
<tr>
<td>heading_collapsed</td>
<td>int | None</td>
<td>None</td>
<td>Collapse heading section?</td>
</tr>
<tr>
<td>pinned</td>
<td>int | None</td>
<td>None</td>
<td>Pin to context?</td>
</tr>
</tbody>
</table>

``` python
_id = add_msg('testing')
```

``` python
_id = update_msg(_id, content='toasting')
```

``` python
_id = update_msg(_id, skipped=1)
```

``` python
del_msg(_id)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L189"
target="_blank" style="float:right; font-size:smaller">source</a>

### url2note

>  url2note (url:str, extract_section:bool=True, selector:str=None)

*Read URL as markdown, and add a note below current message with the
result*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>str</td>
<td></td>
<td>URL to read</td>
</tr>
<tr>
<td>extract_section</td>
<td>bool</td>
<td>True</td>
<td>If url has an anchor, return only that section</td>
</tr>
<tr>
<td>selector</td>
<td>str</td>
<td>None</td>
<td>Select section(s) using BeautifulSoup.select (overrides
extract_section)</td>
</tr>
</tbody>
</table>

``` python
_id = url2note('https://www.example.org')
```

``` python
del_msg(_id)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L199"
target="_blank" style="float:right; font-size:smaller">source</a>

### ast_py

>  ast_py (code:str)

*Get an SgRoot root node for python `code`*

``` python
node = ast_py("print('hello world')")
stmt = node.find(pattern="print($A)")
res = stmt.get_match('A')
res.text(),res.range()
```

    ("'hello world'",
     Range(start=Pos(line=0, col=6, index=6), end=Pos(line=0, col=19, index=19)))

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L205"
target="_blank" style="float:right; font-size:smaller">source</a>

### ast_grep

>  ast_grep (pattern:str, path='.', lang='python')

*Use the `ast-grep` command to find `pattern` in `path`*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>pattern</td>
<td>str</td>
<td></td>
<td>ast-grep pattern to search</td>
</tr>
<tr>
<td>path</td>
<td>str</td>
<td>.</td>
<td>path to recursively search for files</td>
</tr>
<tr>
<td>lang</td>
<td>str</td>
<td>python</td>
<td>language to search/scan</td>
</tr>
</tbody>
</table>

``` python
res = ast_grep(r"xpost($A, data=$B)", '..')
[(o['text'],o['metaVariables']['single'],o['file']) for o in res]
```

    [('xpost(f\'http://localhost:{dh_settings["port"]}/{path}\', data=data)',
      {'A': {'text': 'f\'http://localhost:{dh_settings["port"]}/{path}\'',
        'range': {'byteOffset': {'start': 1869, 'end': 1917},
         'start': {'line': 49, 'column': 16},
         'end': {'line': 49, 'column': 64}}},
       'B': {'text': 'data',
        'range': {'byteOffset': {'start': 1924, 'end': 1928},
         'start': {'line': 49, 'column': 71},
         'end': {'line': 49, 'column': 75}}}},
      'dialoghelper/core.py')]

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L218"
target="_blank" style="float:right; font-size:smaller">source</a>

### read_msg

>  read_msg (n:int=-1, relative:bool=True, msgid:str=None,
>                view_range:list[int,int]=None, nums:bool=False, dname:str='')

*Get the `Message` object indexed in the current dialog.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>n</td>
<td>int</td>
<td>-1</td>
<td>Message index (if relative, +ve is downwards)</td>
</tr>
<tr>
<td>relative</td>
<td>bool</td>
<td>True</td>
<td>Is <code>n</code> relative to current message (True) or absolute
(False)?</td>
</tr>
<tr>
<td>msgid</td>
<td>str</td>
<td>None</td>
<td>Message id to find (defaults to current message)</td>
</tr>
<tr>
<td>view_range</td>
<td>list</td>
<td>None</td>
<td>Optional 1-indexed (start, end) line range for files, end=-1 for
EOF</td>
</tr>
<tr>
<td>nums</td>
<td>bool</td>
<td>False</td>
<td>Whether to show line numbers</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
_edit_id = add_msg('This message should be found.\n\nThis is a multiline message.')
```

``` python
print(read_msg()['msg']['content'])
```

    This message should be found.

    This is a multiline message.

``` python
print(read_msg(n=0, msgid=_edit_id, nums=True)['msg']['content'])
```

         1 │ This message should be found.
         2 │ 
         3 │ This is a multiline message.

``` python
print(read_msg(n=0, msgid=_edit_id, nums=True, view_range=[2,3])['msg']['content'])
```

         2 │ 
         3 │ This is a multiline message.

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L234"
target="_blank" style="float:right; font-size:smaller">source</a>

### run_msg

>  run_msg (msgid:str=None, dname:str='')

*Adds a message to the run queue. Use read_msg to see the output once it
runs.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td>None</td>
<td>id of message to execute</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
1+1
```

    2

``` python
codeid = read_msg()['msg']['id']
```

``` python
run_msg(codeid)
```

    '{"status":"queued"}'

## Text Edit

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L242"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_insert_line

>  msg_insert_line (msgid:str, insert_line:int, new_str:str, dname:str='')

*Insert text at a specific line number in a message*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td></td>
<td>Message id to edit</td>
</tr>
<tr>
<td>insert_line</td>
<td>int</td>
<td></td>
<td>The line number after which to insert the text (0 for beginning of
file)</td>
</tr>
<tr>
<td>new_str</td>
<td>str</td>
<td></td>
<td>The text to insert</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
msg_insert_line(_edit_id, 0, 'This should go to the first line')
msg_insert_line(_edit_id, 3, 'This should go to the 4th line')
msg_insert_line(_edit_id, 5, 'This should go to the last line')
```

    {'success': 'Inserted text after line 5 in message _65ee1825'}

``` python
print(read_msg(n=0, msgid=_edit_id, nums=True)['msg']['content'])
```

         1 │ This should go to the first line
         2 │ This message should be found.
         3 │ 
         4 │ This should go to the 4th line
         5 │ This is a multiline message.
         6 │ This should go to the last line

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L252"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_str_replace

>  msg_str_replace (msgid:str, old_str:str, new_str:str, dname:str='')

*Replace first occurrence of old_str with new_str in a message*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td></td>
<td>Message id to edit</td>
</tr>
<tr>
<td>old_str</td>
<td>str</td>
<td></td>
<td>Text to find and replace</td>
</tr>
<tr>
<td>new_str</td>
<td>str</td>
<td></td>
<td>Text to replace with</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
msg_str_replace(_edit_id, 'This should go to the first line', 'This should go to the 1st line')
```

    {'success': 'Replaced text in message _65ee1825'}

``` python
print(read_msg(n=0, msgid=_edit_id, nums=True)['msg']['content'])
```

         1 │ This should go to the 1st line
         2 │ This message should be found.
         3 │ 
         4 │ This should go to the 4th line
         5 │ This is a multiline message.
         6 │ This should go to the last line

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L262"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_strs_replace

>  msg_strs_replace (msgid:str, old_strs:list[str], new_strs:list[str],
>                        dname:str='')

*Replace multiple strings simultaneously in a message*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td></td>
<td>Message id to edit</td>
</tr>
<tr>
<td>old_strs</td>
<td>list</td>
<td></td>
<td>List of strings to find and replace</td>
</tr>
<tr>
<td>new_strs</td>
<td>list</td>
<td></td>
<td>List of replacement strings (must match length of old_strs)</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
msg_strs_replace(_edit_id, ['This is a multiline message.', 'This should go to the last line'], ['5th line', 'last line'])
```

    {'success': 'Successfully replaced all the strings in message _65ee1825'}

``` python
print(read_msg(n=0, msgid=_edit_id, nums=True)['msg']['content'])
```

         1 │ This should go to the 1st line
         2 │ This message should be found.
         3 │ 
         4 │ This should go to the 4th line
         5 │ 5th line
         6 │ last line

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L272"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_replace_lines

>  msg_replace_lines (msgid:str, start_line:int, end_line:int,
>                         new_content:str, dname:str='')

*Replace a range of lines with new content in a message*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>msgid</td>
<td>str</td>
<td></td>
<td>Message id to edit</td>
</tr>
<tr>
<td>start_line</td>
<td>int</td>
<td></td>
<td>Starting line number to replace (1-based indexing)</td>
</tr>
<tr>
<td>end_line</td>
<td>int</td>
<td></td>
<td>Ending line number to replace (1-based indexing, inclusive)</td>
</tr>
<tr>
<td>new_content</td>
<td>str</td>
<td></td>
<td>New content to replace the specified lines</td>
</tr>
<tr>
<td>dname</td>
<td>str</td>
<td></td>
<td>Running dialog to get info for; defaults to current dialog</td>
</tr>
</tbody>
</table>

``` python
msg_replace_lines(_edit_id, 2, 4,'line 2\nline 3\nline 4\n')
```

    {'success': 'Replaced lines 2 to 4 in message _65ee1825'}

``` python
print(read_msg(n=0, msgid=_edit_id, nums=True)['msg']['content'])
```

         1 │ This should go to the 1st line
         2 │ line 2
         3 │ line 3
         4 │ line 4
         5 │ 5th line
         6 │ last line

``` python
del_msg(_edit_id)
```

## Gists

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L283"
target="_blank" style="float:right; font-size:smaller">source</a>

### load_gist

>  load_gist (gist_id:str)

*Retrieve a gist*

``` python
gistid = 'jph00/e7cfd4ded593e8ef6217e78a0131960c'
gist = load_gist(gistid)
gist.html_url
```

    'https://gist.github.com/jph00/e7cfd4ded593e8ef6217e78a0131960c'

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L291"
target="_blank" style="float:right; font-size:smaller">source</a>

### gist_file

>  gist_file (gist_id:str)

*Get the first file from a gist*

``` python
gfile = gist_file(gistid)
print(gfile.content[:100]+"…")
```

    "This is a test module which makes some simple tools available."
    __all__ = ["hi","whoami"]

    testfoo=…

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L297"
target="_blank" style="float:right; font-size:smaller">source</a>

### import_string

>  import_string (code:str, name:str)

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>code</td>
<td>str</td>
<td>Code to import as a module</td>
</tr>
<tr>
<td>name</td>
<td>str</td>
<td>Name of module to create</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L315"
target="_blank" style="float:right; font-size:smaller">source</a>

### is_usable_tool

>  is_usable_tool (func:<built-infunctioncallable>)

*True if the function has a docstring and all parameters have types,
meaning that it can be used as an LLM tool.*

``` python
def hi(who:str):
    "Say hi to `who`"
    return f"Hello {who}"

def hi2(who):
    "Say hi to `who`"
    return f"Hello {who}"

def hi3(who:str):
    return f"Hello {who}"

bye = "bye"
```

``` python
assert is_usable_tool(hi)
assert not is_usable_tool(hi2)
assert not is_usable_tool(hi3)
assert not is_usable_tool(bye)
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L321"
target="_blank" style="float:right; font-size:smaller">source</a>

### mk_toollist

>  mk_toollist (syms)

``` python
Markdown(mk_toollist([hi]))
```

- &`hi`: Say hi to `who`

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L325"
target="_blank" style="float:right; font-size:smaller">source</a>

### import_gist

>  import_gist (gist_id:str, mod_name:str=None, add_global:bool=True,
>                   import_wildcard:bool=False, create_msg:bool=False)

*Import gist directly from string without saving to disk*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>gist_id</td>
<td>str</td>
<td></td>
<td>user/id or just id of gist to import as a module</td>
</tr>
<tr>
<td>mod_name</td>
<td>str</td>
<td>None</td>
<td>module name to create (taken from gist filename if not passed)</td>
</tr>
<tr>
<td>add_global</td>
<td>bool</td>
<td>True</td>
<td>add module to caller’s globals?</td>
</tr>
<tr>
<td>import_wildcard</td>
<td>bool</td>
<td>False</td>
<td>import all exported symbols to caller’s globals</td>
</tr>
<tr>
<td>create_msg</td>
<td>bool</td>
<td>False</td>
<td>Add a message that lists usable tools</td>
</tr>
</tbody>
</table>

``` python
import_gist(gistid)
importtest.testfoo
```

    'testbar'

``` python
import_gist.__doc__
```

    'Import gist directly from string without saving to disk'

``` python
import_gist(gistid, import_wildcard=True)
importtest.testfoo
```

    'testbar'

``` python
hi("Sarah")
```

    'Hello Sarah'

``` python
importtest.__all__
```

    ['hi', 'whoami']

## Tool info

This is how we get a superset of tools to include:

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L349"
target="_blank" style="float:right; font-size:smaller">source</a>

### tool_info

>  tool_info ()

``` python
from dialoghelper.core import __all__ as _all
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/core.py#L374"
target="_blank" style="float:right; font-size:smaller">source</a>

### fc_tool_info

>  fc_tool_info ()

``` python
for o in _all:
    s = globals()[o]
    print(o)
    if not hasattr(s, '__name__') or s.__name__[0]=='_' or not s.__doc__: continue
    print(f'- &`{s.__name__}`: {s.__doc__}')
```

    dh_settings
    Placements
    empty
    find_var
    - &`find_var`: Search for var in all frames of the call stack
    set_var
    - &`set_var`: Set var to val after finding it in all frames of the call stack
    call_endp
    find_dname
    - &`find_dname`: Get the message id by searching the call stack for __dialog_id.
    find_msg_id
    - &`find_msg_id`: Get the message id by searching the call stack for __dialog_id.
    curr_dialog
    - &`curr_dialog`: Get the current dialog info.
    find_msgs
    - &`find_msgs`: Find `list[dict]` of messages in current specific dialog that contain the given information. To refer to a message found later, use its `id` field.
    msg_idx
    - &`msg_idx`: Get absolute index of message in dialog.
    add_html
    - &`add_html`: Send HTML to the browser to be swapped into the DOM
    add_msg
    - &`add_msg`: Add/update a message to the queue to show after code execution completes.
    del_msg
    - &`del_msg`: Delete a message from the dialog.
    update_msg
    - &`update_msg`: Update an existing message. Provide either `msg` OR field key/values to update.
        Use `content` param to update contents.
        Only include parameters to update--missing ones will be left unchanged.
    url2note
    - &`url2note`: Read URL as markdown, and add a note below current message with the result
    ast_py
    - &`ast_py`: Get an SgRoot root node for python `code`
    ast_grep
    - &`ast_grep`: Use the `ast-grep` command to find `pattern` in `path`
    read_msg
    - &`read_msg`: Get the `Message` object indexed in the current dialog.
    run_msg
    - &`run_msg`: Adds a message to the run queue. Use read_msg to see the output once it runs.
    msg_insert_line
    - &`msg_insert_line`: Insert text at a specific line number in a message
    msg_str_replace
    - &`msg_str_replace`: Replace first occurrence of old_str with new_str in a message
    msg_strs_replace
    - &`msg_strs_replace`: Replace multiple strings simultaneously in a message
    msg_replace_lines
    - &`msg_replace_lines`: Replace a range of lines with new content in a message
    load_gist
    - &`load_gist`: Retrieve a gist
    gist_file
    - &`gist_file`: Get the first file from a gist
    import_string
    is_usable_tool
    - &`is_usable_tool`: True if the function has a docstring and all parameters have types, meaning that it can be used as an LLM tool.
    mk_toollist
    import_gist
    - &`import_gist`: Import gist directly from string without saving to disk
    tool_info
    fc_tool_info

``` python
for o in tools.__all__:
    s = getattr(tools, o)
    print(f'- &`{s.__name__}`: {s.__doc__}')
```

    - &`run_cmd`: Run `cmd` passing split `argstr`, optionally checking for allowed argstr
    - &`rg`: Run the `rg` command with the args in `argstr` (no need to backslash escape)
    - &`sed`: Run the `sed` command with the args in `argstr` (e.g for reading a section of a file)
    - &`view`: View directory or file contents with optional line range and numbers
    - &`create`: Creates a new file with the given content at the specified path
    - &`insert`: Insert new_str at specified line number
    - &`str_replace`: Replace first occurrence of old_str with new_str in file
    - &`strs_replace`: Replace for each str pair in old_strs,new_strs
    - &`replace_lines`: Replace lines in file using start and end line-numbers (index starting at 1)
