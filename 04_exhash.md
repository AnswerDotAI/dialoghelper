

<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

``` python
from fastcore.utils import *
```

The quick brown fox jumps over the lazy dog. Jackdaws love my big sphinx
of quartz. Pack my box with five dozen liquor jugs. How vexingly quick
daft zebras jump! The five boxing wizards jump quickly. Sphinx of black
quartz, judge my vow. Two driven jocks help fax my big quiz. Bright
vixens jump; dozy fowl quack.

``` python
msg = await read_msg()
id_ = msg.id
cts = msg.content
```

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/exhash.py#L11"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_lnhashview

``` python

async def msg_lnhashview(
    id:str
):

```

*Show lnhash-addressed lines of a message*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/exhash.py#L17"
target="_blank" style="float:right; font-size:smaller">source</a>

### msg_exhash

``` python

async def msg_exhash(
    id:str, cmds:list
):

```

*Verified line-addressed editor. Apply commands to msg `id` contents,
return lnhashview(result).* **NB**: *all* exhash commands *must* start
with an address. The *only* allowed addresses are a single lnhash, or a
pair separated by `,`. (I.e no `%`, `.`, etc.) **NB**: hashes are
checked only *once* before all commands are run. So passing multiple
commands work fine, even if hashes change.

Commands are like `ex`, but use lnhash addresses instead of bare line
numbers: `lineno|hash|cmd` where hash is a 4-char hex content hash. Use
`msg_lnhashview(text)` to get addresses before first use.

Addressing: Single: `12|a3f2|cmd` Range: `12|a3f2|,15|b1c3|cmd` Special:
`0|0000|` targets before line 1 (only with a or i)

Commands: s/pat/rep/\[flags\] Substitute (regex). Flags: g=all,
i=case-insensitive d Delete line(s) a Append text after line i Insert
text before line c Change/replace line(s) j Join with next line; with
range, joins all m dest Move line(s) after dest address t dest Copy
line(s) after dest address \>\[n\] Indent n levels (default 1, 4 spaces
each) \<\[n\] Dedent n levels (default 1) sort Sort lines alphabetically
p Print (include in output without changing) g/pat/cmd Global: run cmd
on matching lines g!/pat/cmd Inverted global (also v/pat/cmd)

`cmds` is a required list of command strings. For `a`/`i`/`c`, include
the text block in the same command string after a newline.

Are &`[msg_lnhashview,msg_exhash]` clear? Want to try them? In the raw
message above, move lines 2&3 to the end.

##### ğŸ¤–ReplyğŸ¤–<!-- SOLVEIT_SEPARATOR_7f3a9b2c -->

ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ 

Sure! Let me get the hashes first:
<details class="tool-usage-details">

<summary>

msg_lnhashview(id=â€™\_d505d014â€™)
</summary>

``` json
{
  "id": "toolu_01UcJacqwEvEyKPDSxazQ5KC",
  "call": {
    "function": "msg_lnhashview",
    "arguments": {
      "id": "_d505d014"
    }
  },
  "result": "1|da2a|  The quick brown fox jumps over the lazy dog.\n2|d61c|  Two driven jocks help fax my big quiz.\n3|bc1b|  Bright vixens jump; dozy fowl quack.\n4|32e4|  Jackdaws love my big sphinx of quartz.\n5|04e4|  Pack my box with five dozen liquor jugs.\n6|025f|  How vexingly quick daft zebras jump!\n7|c720|  The five boxing wizards jump quickly.\n8|0666|  Sphinx of black quartz, judge my vow."
}
```

</details>

Now move lines 2â€“3 after line 8:

<details class="tool-usage-details">

<summary>

msg_exhash(id=â€™\_d505d014â€™, cmds=\[â€˜2|d61c|,3|bc1b|m 8|0666|â€™\])
</summary>

``` json
{
  "id": "toolu_01DURnbgDRkEerb5i7vfJRHC",
  "call": {
    "function": "msg_exhash",
    "arguments": {
      "id": "_d505d014",
      "cmds": "['2|d61c|,3|bc1b|m 8|0666|']"
    }
  },
  "result": "1|da2a|  The quick brown fox jumps over the lazy dog.\n2|32e4|  Jackdaws love my big sphinx of quartz.\n3|04e4|  Pack my box with five dozen liquor jugs.\n4|025f|  How vexingly quick daft zebras jump!\n5|c720|  The five boxing wizards jump quickly.\n6|0666|  Sphinx of black quartz, judge my vow.\n7|d61c|  Two driven jocks help fax my big quiz.\n8|bc1b|  Bright vixens jump; dozy fowl quack."
}
```

</details>

Done! â€œTwo driven jocksâ€¦â€ and â€œBright vixensâ€¦â€ are now at the end. The
hashes confirm the content moved correctly â€” you can see `d61c` and
`bc1b` shifted from lines 2â€“3 to lines 7â€“8.

Create for me `file_` versions of those two functions, which take a path
str instead of msg id.

##### ğŸ¤–ReplyğŸ¤–<!-- SOLVEIT_SEPARATOR_7f3a9b2c -->

ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ ğŸ§ 

``` python
def file_lnhashview(path):
    "Show lnhash-addressed lines of a file"
    return '\n'.join(lnhashview(Path(path).read_text()))

def file_exhash(path, cmds):
    "Verified line-addressed editor for files. Apply commands to file at `path`, return lnhashview(result)."
    txt = Path(path).read_text()
    res = '\n'.join(exhash(txt, cmds)['lines'])
    Path(path).write_text(res)
    return '\n'.join(lnhashview(res))
```

<details class="token-usage-details">

<summary>

Cache hit: 0.0% | Tokens: total=42,966 input=42,325 (+0 cached, 42,120
new) output=641
</summary>

`Usage(completion_tokens=641, prompt_tokens=42325, total_tokens=42966, completion_tokens_details=CompletionTokensDetailsWrapper(accepted_prediction_tokens=None, audio_tokens=None, reasoning_tokens=0, rejected_prediction_tokens=None, text_tokens=641, image_tokens=None), prompt_tokens_details=PromptTokensDetailsWrapper(audio_tokens=None, cached_tokens=0, text_tokens=None, image_tokens=None, cache_creation_tokens=42120), cache_creation_input_tokens=42120, cache_read_input_tokens=0)`

</details>

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/exhash.py#L57"
target="_blank" style="float:right; font-size:smaller">source</a>

### file_lnhashview

``` python

def file_lnhashview(
    path:str
):

```

*Show lnhash-addressed lines of a file*

------------------------------------------------------------------------

<a
href="https://github.com/AnswerDotAI/dialoghelper/blob/main/dialoghelper/exhash.py#L62"
target="_blank" style="float:right; font-size:smaller">source</a>

### file_exhash

``` python

def file_exhash(
    path:str, cmds:list
):

```

*Verified line-addressed editor for files. Apply commands to file at
`path`, return lnhashview(result).* See `doc(msg_lnhashview)` for
details

``` python
tp = Path('tmp.txt')
tp.write_text(cts)
```

    313

Try indenting the first 3 lines of this file with
&`[file_lnhashview,file_exhash]`.

##### ğŸ¤–ReplyğŸ¤–<!-- SOLVEIT_SEPARATOR_7f3a9b2c -->

<details class="tool-usage-details">

<summary>

file_lnhashview(path=â€˜tmp.txtâ€™)
</summary>

``` json
{
  "id": "toolu_01T723e8w3tcYjgdEwNopV18",
  "call": {
    "function": "file_lnhashview",
    "arguments": {
      "path": "tmp.txt"
    }
  },
  "result": "1|da2a|  The quick brown fox jumps over the lazy dog.\n2|32e4|  Jackdaws love my big sphinx of quartz.\n3|04e4|  Pack my box with five dozen liquor jugs.\n4|025f|  How vexingly quick daft zebras jump!\n5|c720|  The five boxing wizards jump quickly.\n6|0666|  Sphinx of black quartz, judge my vow.\n7|d61c|  Two driven jocks help fax my big quiz.\n8|bc1b|  Bright vixens jump; dozy fowl quack."
}
```

</details>

<details class="tool-usage-details">

<summary>

file_exhash(path=â€˜tmp.txtâ€™, cmds=\[â€˜1|da2a|,3|04e4|\>â€™\])
</summary>

``` json
{
  "id": "toolu_01QdybzYCodQBHB5WKMo7Z92",
  "call": {
    "function": "file_exhash",
    "arguments": {
      "path": "tmp.txt",
      "cmds": "['1|da2a|,3|04e4|>']"
    }
  },
  "result": "1|dfab|      The quick brown fox jumps over the lazy dog.\n2|e110|      Jackdaws love my big sphinx of quartz.\n3|a4ce|      Pack my box with five dozen liquor jugs.\n4|025f|  How vexingly quick daft zebras jump!\n5|c720|  The five boxing wizards jump quickly.\n6|0666|  Sphinx of black quartz, judge my vow.\n7|d61c|  Two driven jocks help fax my big quiz.\n8|bc1b|  Bright vixens jump; dozy fowl quack."
}
```

</details>

Done â€” first 3 lines are now indented. You can see the hashes changed
for those lines (`da2a`â†’`dfab`, etc.) since the content now includes
leading spaces.

``` python
print(tp.read_text())
```

        The quick brown fox jumps over the lazy dog.
        Jackdaws love my big sphinx of quartz.
        Pack my box with five dozen liquor jugs.
    How vexingly quick daft zebras jump!
    The five boxing wizards jump quickly.
    Sphinx of black quartz, judge my vow.
    Two driven jocks help fax my big quiz.
    Bright vixens jump; dozy fowl quack.

``` python
tp.unlink()
```
